{"version":3,"sources":["../../../../node_modules/babel-plugin-transform-es2015-parameters/lib/default.js"],"names":["exports","__esModule","visitor","undefined","_getIterator2","require","_getIterator3","_interopRequireDefault","_babelHelperGetFunctionArity","_babelHelperGetFunctionArity2","_babelHelperCallDelegate","_babelHelperCallDelegate2","_babelTemplate","_babelTemplate2","_babelTypes","t","_interopRequireWildcard","obj","newObj","key","Object","prototype","hasOwnProperty","call","default","buildDefaultParam","buildCutOff","hasDefaults","node","_iterator","params","_isArray","Array","isArray","_i","_ref","length","next","done","value","param","isIdentifier","isSafeBinding","scope","hasOwnBinding","name","_scope$getOwnBinding","getOwnBinding","kind","iifeVisitor","ReferencedIdentifier","path","state","iife","stop","Scope","skip","Function","ensureBlock","body","argsIdentifier","identifier","_shadowedFunctionLiteral","pushDefNode","left","right","i","defNode","VARIABLE_NAME","DEFAULT_VALUE","ARGUMENT_KEY","numericLiteral","ARGUMENTS","_blockHoist","push","lastNonDefaultParam","get","isAssignmentPattern","traverse","isPattern","placeholder","generateUidIdentifier","_isDefaultPlaceholder","_i2","_param","declar","slice","set","blockStatement","unshiftContainer"],"mappings":"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","file":"default.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.visitor = undefined;\n\nvar _getIterator2 = require(\"babel-runtime/core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _babelHelperGetFunctionArity = require(\"babel-helper-get-function-arity\");\n\nvar _babelHelperGetFunctionArity2 = _interopRequireDefault(_babelHelperGetFunctionArity);\n\nvar _babelHelperCallDelegate = require(\"babel-helper-call-delegate\");\n\nvar _babelHelperCallDelegate2 = _interopRequireDefault(_babelHelperCallDelegate);\n\nvar _babelTemplate = require(\"babel-template\");\n\nvar _babelTemplate2 = _interopRequireDefault(_babelTemplate);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar buildDefaultParam = (0, _babelTemplate2.default)(\"\\n  let VARIABLE_NAME =\\n    ARGUMENTS.length > ARGUMENT_KEY && ARGUMENTS[ARGUMENT_KEY] !== undefined ?\\n      ARGUMENTS[ARGUMENT_KEY]\\n    :\\n      DEFAULT_VALUE;\\n\");\n\nvar buildCutOff = (0, _babelTemplate2.default)(\"\\n  let $0 = $1[$2];\\n\");\n\nfunction hasDefaults(node) {\n  for (var _iterator = node.params, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : (0, _getIterator3.default)(_iterator);;) {\n    var _ref;\n\n    if (_isArray) {\n      if (_i >= _iterator.length) break;\n      _ref = _iterator[_i++];\n    } else {\n      _i = _iterator.next();\n      if (_i.done) break;\n      _ref = _i.value;\n    }\n\n    var param = _ref;\n\n    if (!t.isIdentifier(param)) return true;\n  }\n  return false;\n}\n\nfunction isSafeBinding(scope, node) {\n  if (!scope.hasOwnBinding(node.name)) return true;\n\n  var _scope$getOwnBinding = scope.getOwnBinding(node.name),\n      kind = _scope$getOwnBinding.kind;\n\n  return kind === \"param\" || kind === \"local\";\n}\n\nvar iifeVisitor = {\n  ReferencedIdentifier: function ReferencedIdentifier(path, state) {\n    var scope = path.scope,\n        node = path.node;\n\n    if (node.name === \"eval\" || !isSafeBinding(scope, node)) {\n      state.iife = true;\n      path.stop();\n    }\n  },\n  Scope: function Scope(path) {\n    path.skip();\n  }\n};\n\nvar visitor = exports.visitor = {\n  Function: function Function(path) {\n    var node = path.node,\n        scope = path.scope;\n\n    if (!hasDefaults(node)) return;\n\n    path.ensureBlock();\n\n    var state = {\n      iife: false,\n      scope: scope\n    };\n\n    var body = [];\n\n    var argsIdentifier = t.identifier(\"arguments\");\n    argsIdentifier._shadowedFunctionLiteral = path;\n\n    function pushDefNode(left, right, i) {\n      var defNode = buildDefaultParam({\n        VARIABLE_NAME: left,\n        DEFAULT_VALUE: right,\n        ARGUMENT_KEY: t.numericLiteral(i),\n        ARGUMENTS: argsIdentifier\n      });\n      defNode._blockHoist = node.params.length - i;\n      body.push(defNode);\n    }\n\n    var lastNonDefaultParam = (0, _babelHelperGetFunctionArity2.default)(node);\n\n    var params = path.get(\"params\");\n    for (var i = 0; i < params.length; i++) {\n      var param = params[i];\n\n      if (!param.isAssignmentPattern()) {\n        if (!state.iife && !param.isIdentifier()) {\n          param.traverse(iifeVisitor, state);\n        }\n\n        continue;\n      }\n\n      var left = param.get(\"left\");\n      var right = param.get(\"right\");\n\n      if (i >= lastNonDefaultParam || left.isPattern()) {\n        var placeholder = scope.generateUidIdentifier(\"x\");\n        placeholder._isDefaultPlaceholder = true;\n        node.params[i] = placeholder;\n      } else {\n        node.params[i] = left.node;\n      }\n\n      if (!state.iife) {\n        if (right.isIdentifier() && !isSafeBinding(scope, right.node)) {\n          state.iife = true;\n        } else {\n          right.traverse(iifeVisitor, state);\n        }\n      }\n\n      pushDefNode(left.node, right.node, i);\n    }\n\n    for (var _i2 = lastNonDefaultParam + 1; _i2 < node.params.length; _i2++) {\n      var _param = node.params[_i2];\n      if (_param._isDefaultPlaceholder) continue;\n\n      var declar = buildCutOff(_param, argsIdentifier, t.numericLiteral(_i2));\n      declar._blockHoist = node.params.length - _i2;\n      body.push(declar);\n    }\n\n    node.params = node.params.slice(0, lastNonDefaultParam);\n\n    if (state.iife) {\n      body.push((0, _babelHelperCallDelegate2.default)(path, scope));\n      path.set(\"body\", t.blockStatement(body));\n    } else {\n      path.get(\"body\").unshiftContainer(\"body\", body);\n    }\n  }\n};"]}