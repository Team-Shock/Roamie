{"version":3,"sources":["../../../../node_modules/babel-plugin-transform-es2015-modules-amd/lib/index.js"],"names":["exports","__esModule","_create","require","_create2","_interopRequireDefault","default","_ref","t","types","isValidRequireCall","path","isCallExpression","get","isIdentifier","name","scope","getBinding","args","length","arg","isStringLiteral","amdVisitor","ReferencedIdentifier","_ref2","node","hasExports","hasModule","CallExpression","bareSources","push","arguments","remove","VariableDeclarator","id","init","source","sourceNames","value","sources","inherits","pre","visitor","Program","exit","_this","ran","traverse","params","map","concat","filter","str","moduleName","getModuleName","stringLiteral","unshift","identifier","factory","buildFactory","PARAMS","BODY","body","expression","directives","buildDefine","MODULE_NAME","SOURCES","FACTORY","_babelTemplate","_babelTemplate2","obj","module"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nvar _create = require(\"babel-runtime/core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nexports.default = function (_ref) {\n  var t = _ref.types;\n\n  function isValidRequireCall(path) {\n    if (!path.isCallExpression()) return false;\n    if (!path.get(\"callee\").isIdentifier({ name: \"require\" })) return false;\n    if (path.scope.getBinding(\"require\")) return false;\n\n    var args = path.get(\"arguments\");\n    if (args.length !== 1) return false;\n\n    var arg = args[0];\n    if (!arg.isStringLiteral()) return false;\n\n    return true;\n  }\n\n  var amdVisitor = {\n    ReferencedIdentifier: function ReferencedIdentifier(_ref2) {\n      var node = _ref2.node,\n          scope = _ref2.scope;\n\n      if (node.name === \"exports\" && !scope.getBinding(\"exports\")) {\n        this.hasExports = true;\n      }\n\n      if (node.name === \"module\" && !scope.getBinding(\"module\")) {\n        this.hasModule = true;\n      }\n    },\n    CallExpression: function CallExpression(path) {\n      if (!isValidRequireCall(path)) return;\n      this.bareSources.push(path.node.arguments[0]);\n      path.remove();\n    },\n    VariableDeclarator: function VariableDeclarator(path) {\n      var id = path.get(\"id\");\n      if (!id.isIdentifier()) return;\n\n      var init = path.get(\"init\");\n      if (!isValidRequireCall(init)) return;\n\n      var source = init.node.arguments[0];\n      this.sourceNames[source.value] = true;\n      this.sources.push([id.node, source]);\n\n      path.remove();\n    }\n  };\n\n  return {\n    inherits: require(\"babel-plugin-transform-es2015-modules-commonjs\"),\n\n    pre: function pre() {\n      this.sources = [];\n      this.sourceNames = (0, _create2.default)(null);\n\n      this.bareSources = [];\n\n      this.hasExports = false;\n      this.hasModule = false;\n    },\n\n\n    visitor: {\n      Program: {\n        exit: function exit(path) {\n          var _this = this;\n\n          if (this.ran) return;\n          this.ran = true;\n\n          path.traverse(amdVisitor, this);\n\n          var params = this.sources.map(function (source) {\n            return source[0];\n          });\n          var sources = this.sources.map(function (source) {\n            return source[1];\n          });\n\n          sources = sources.concat(this.bareSources.filter(function (str) {\n            return !_this.sourceNames[str.value];\n          }));\n\n          var moduleName = this.getModuleName();\n          if (moduleName) moduleName = t.stringLiteral(moduleName);\n\n          if (this.hasExports) {\n            sources.unshift(t.stringLiteral(\"exports\"));\n            params.unshift(t.identifier(\"exports\"));\n          }\n\n          if (this.hasModule) {\n            sources.unshift(t.stringLiteral(\"module\"));\n            params.unshift(t.identifier(\"module\"));\n          }\n\n          var node = path.node;\n\n          var factory = buildFactory({\n            PARAMS: params,\n            BODY: node.body\n          });\n          factory.expression.body.directives = node.directives;\n          node.directives = [];\n\n          node.body = [buildDefine({\n            MODULE_NAME: moduleName,\n            SOURCES: sources,\n            FACTORY: factory\n          })];\n        }\n      }\n    }\n  };\n};\n\nvar _babelTemplate = require(\"babel-template\");\n\nvar _babelTemplate2 = _interopRequireDefault(_babelTemplate);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar buildDefine = (0, _babelTemplate2.default)(\"\\n  define(MODULE_NAME, [SOURCES], FACTORY);\\n\");\n\nvar buildFactory = (0, _babelTemplate2.default)(\"\\n  (function (PARAMS) {\\n    BODY;\\n  })\\n\");\n\nmodule.exports = exports[\"default\"];"]}