{"version":3,"sources":["../../../../node_modules/babel-preset-env/lib/index.js"],"names":["exports","__esModule","transformIncludesAndExcludes","isPluginRequired","undefined","default","buildPreset","_semver","require","_semver2","_interopRequireDefault","_builtIns","_builtIns2","_defaultIncludes","_moduleTransformations","_moduleTransformations2","_normalizeOptions","_normalizeOptions2","_plugins","_plugins2","_transformPolyfillRequirePlugin","_transformPolyfillRequirePlugin2","_targetsParser","_targetsParser2","_utils","obj","supportedEnvironments","plugin","targetEnvironments","Object","keys","length","isRequiredForEnvironments","filter","environment","lowestImplementedVersion","lowestTargetedVersion","valid","Error","gt","semverify","hasBeenLogged","logPlugin","targets","list","envList","filteredList","reduce","a","b","lt","prettifyVersion","logStr","JSON","stringify","console","log","filterItem","exclusions","item","isDefault","defaultWebIncludes","indexOf","notExcluded","isRequired","getBuiltInTargets","builtInTargets","_extends","uglify","opts","all","plugins","opt","match","builtIns","getPlatformSpecificDefaultFor","targetNames","isAnyTarget","isWebTarget","some","name","context","arguments","validatedOptions","debug","loose","moduleType","spec","useBuiltIns","include","exclude","filterPlugins","bind","transformations","concat","polyfills","polyfillTargets","filterBuiltIns","prettifyTargets","forEach","transform","polyfill","regenerator","modulePlugin","push","apply","map","pluginName"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.transformIncludesAndExcludes = exports.isPluginRequired = undefined;\nexports.default = buildPreset;\n\nvar _semver = require(\"semver\");\n\nvar _semver2 = _interopRequireDefault(_semver);\n\nvar _builtIns = require(\"../data/built-ins.json\");\n\nvar _builtIns2 = _interopRequireDefault(_builtIns);\n\nvar _defaultIncludes = require(\"./default-includes\");\n\nvar _moduleTransformations = require(\"./module-transformations\");\n\nvar _moduleTransformations2 = _interopRequireDefault(_moduleTransformations);\n\nvar _normalizeOptions = require(\"./normalize-options.js\");\n\nvar _normalizeOptions2 = _interopRequireDefault(_normalizeOptions);\n\nvar _plugins = require(\"../data/plugins.json\");\n\nvar _plugins2 = _interopRequireDefault(_plugins);\n\nvar _transformPolyfillRequirePlugin = require(\"./transform-polyfill-require-plugin\");\n\nvar _transformPolyfillRequirePlugin2 = _interopRequireDefault(_transformPolyfillRequirePlugin);\n\nvar _targetsParser = require(\"./targets-parser\");\n\nvar _targetsParser2 = _interopRequireDefault(_targetsParser);\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Determine if a transformation is required\n *\n * NOTE: This assumes `supportedEnvironments` has already been parsed by `getTargets`\n *\n * @param  {Object}  supportedEnvironments  An Object containing environment keys and the lowest\n *                                          supported version as a value\n * @param  {Object}  plugin                 An Object containing environment keys and the lowest\n *                                          version the feature was implemented in as a value\n * @return {Boolean} Whether or not the transformation is required\n */\nvar isPluginRequired = exports.isPluginRequired = function isPluginRequired(supportedEnvironments, plugin) {\n  var targetEnvironments = Object.keys(supportedEnvironments);\n\n  if (targetEnvironments.length === 0) {\n    return true;\n  }\n\n  var isRequiredForEnvironments = targetEnvironments.filter(function (environment) {\n    // Feature is not implemented in that environment\n    if (!plugin[environment]) {\n      return true;\n    }\n\n    var lowestImplementedVersion = plugin[environment];\n    var lowestTargetedVersion = supportedEnvironments[environment];\n\n    if (!_semver2.default.valid(lowestTargetedVersion)) {\n      throw new Error(\n      // eslint-disable-next-line max-len\n      \"Invalid version passed for target \\\"\" + environment + \"\\\": \\\"\" + lowestTargetedVersion + \"\\\". Versions must be in semver format (major.minor.patch)\");\n    }\n\n    return _semver2.default.gt((0, _utils.semverify)(lowestImplementedVersion), lowestTargetedVersion);\n  });\n\n  return isRequiredForEnvironments.length > 0;\n};\n\nvar hasBeenLogged = false;\n\nvar logPlugin = function logPlugin(plugin, targets, list) {\n  var envList = list[plugin] || {};\n  var filteredList = Object.keys(targets).reduce(function (a, b) {\n    if (!envList[b] || _semver2.default.lt(targets[b], (0, _utils.semverify)(envList[b]))) {\n      a[b] = (0, _utils.prettifyVersion)(targets[b]);\n    }\n    return a;\n  }, {});\n  var logStr = \"  \" + plugin + \" \" + JSON.stringify(filteredList);\n  console.log(logStr);\n};\n\nvar filterItem = function filterItem(targets, exclusions, list, item) {\n  var isDefault = _defaultIncludes.defaultWebIncludes.indexOf(item) >= 0;\n  var notExcluded = exclusions.indexOf(item) === -1;\n\n  if (isDefault) return notExcluded;\n  var isRequired = isPluginRequired(targets, list[item]);\n  return isRequired && notExcluded;\n};\n\nvar getBuiltInTargets = function getBuiltInTargets(targets) {\n  var builtInTargets = (0, _utils._extends)({}, targets);\n  if (builtInTargets.uglify != null) {\n    delete builtInTargets.uglify;\n  }\n  return builtInTargets;\n};\n\nvar transformIncludesAndExcludes = exports.transformIncludesAndExcludes = function transformIncludesAndExcludes(opts) {\n  return {\n    all: opts,\n    plugins: opts.filter(function (opt) {\n      return !opt.match(/^(es\\d+|web)\\./);\n    }),\n    builtIns: opts.filter(function (opt) {\n      return opt.match(/^(es\\d+|web)\\./);\n    })\n  };\n};\n\nfunction getPlatformSpecificDefaultFor(targets) {\n  var targetNames = Object.keys(targets);\n  var isAnyTarget = !targetNames.length;\n  var isWebTarget = targetNames.some(function (name) {\n    return name !== \"node\";\n  });\n\n  return isAnyTarget || isWebTarget ? _defaultIncludes.defaultWebIncludes : [];\n}\n\nfunction buildPreset(context) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var validatedOptions = (0, _normalizeOptions2.default)(opts);\n  var debug = validatedOptions.debug,\n      loose = validatedOptions.loose,\n      moduleType = validatedOptions.moduleType,\n      spec = validatedOptions.spec,\n      useBuiltIns = validatedOptions.useBuiltIns;\n\n\n  var targets = (0, _targetsParser2.default)(validatedOptions.targets);\n  var include = transformIncludesAndExcludes(validatedOptions.include);\n  var exclude = transformIncludesAndExcludes(validatedOptions.exclude);\n\n  var filterPlugins = filterItem.bind(null, targets, exclude.plugins, _plugins2.default);\n  var transformations = Object.keys(_plugins2.default).filter(filterPlugins).concat(include.plugins);\n\n  var polyfills = void 0;\n  var polyfillTargets = void 0;\n  if (useBuiltIns) {\n    polyfillTargets = getBuiltInTargets(targets);\n    var filterBuiltIns = filterItem.bind(null, polyfillTargets, exclude.builtIns, _builtIns2.default);\n    polyfills = Object.keys(_builtIns2.default).concat(getPlatformSpecificDefaultFor(polyfillTargets)).filter(filterBuiltIns).concat(include.builtIns);\n  }\n\n  if (debug && !hasBeenLogged) {\n    hasBeenLogged = true;\n    console.log(\"babel-preset-env: `DEBUG` option\");\n    console.log(\"\\nUsing targets:\");\n    console.log(JSON.stringify((0, _utils.prettifyTargets)(targets), null, 2));\n    console.log(\"\\nModules transform: \" + moduleType);\n    console.log(\"\\nUsing plugins:\");\n    transformations.forEach(function (transform) {\n      logPlugin(transform, targets, _plugins2.default);\n    });\n    if (useBuiltIns && polyfills.length) {\n      console.log(\"\\nUsing polyfills:\");\n      polyfills.forEach(function (polyfill) {\n        logPlugin(polyfill, polyfillTargets, _builtIns2.default);\n      });\n    }\n  }\n\n  var regenerator = transformations.indexOf(\"transform-regenerator\") >= 0;\n  var modulePlugin = moduleType !== false && _moduleTransformations2.default[moduleType];\n  var plugins = [];\n\n  // NOTE: not giving spec here yet to avoid compatibility issues when\n  // babel-plugin-transform-es2015-modules-commonjs gets its spec mode\n  modulePlugin && plugins.push([require(\"babel-plugin-\" + modulePlugin), { loose: loose }]);\n\n  plugins.push.apply(plugins, transformations.map(function (pluginName) {\n    return [require(\"babel-plugin-\" + pluginName), { spec: spec, loose: loose }];\n  }));\n\n  useBuiltIns && plugins.push([_transformPolyfillRequirePlugin2.default, { polyfills: polyfills, regenerator: regenerator }]);\n\n  return {\n    plugins: plugins\n  };\n}"]}